---
layout: single
title:  "Java 객체지향 프로그래밍 #6"
---
### 다형성(polymorphism)
#### 다형성이란?
자바에서는 한 타입의 참조변수로 여려 타입의 객체를 참조할 수 있도록 함으로써  
다형성을 프로그램적으로 구현하였다.  
**조상클래스 타입의 참조변수로 자손클래스의 인스턴스를 참조할 수 있도록 하였다.**

<img width="452" alt="polymorphism-image-01" src="https://user-images.githubusercontent.com/97990285/151453643-760f676a-1966-496d-b037-ca8715a7b68a.png">  
Tv와 CaptionTv클래스가 서로 상속관계에 있을 경우,  
**조상클래스 타입의 참조변수로 자손 클래스의 인스턴스를 참조**하도록 하는 것도 가능하다.  
```java
CaptionTv c = new CaptionTv();
TV t = new CaptionTv();
```
TV타입의 참조변수로는 CaptionTv인스턴스 중에서 Tv클래스의 멤버들만 사용할 수 있다.  
**둘 다 같은 타입의 인스턴스지만 참조변수의 타입에 따라 사용할 수 있는 멤버의 개수가 달라진다.**

```java
CaptionTv c = new Tv(); // 에러발생
```
**참조변수가 사용할 수 있는 멤버의 개수는 인스턴스의 멤버 개수보다 같거나 적어야 한다.**

#### 참조변수의 형변환
> **자손타입 -> 조상타입(Up-casting) : 형변환 생략가능**  
> **자손타입 <- 조상타입(Down-casting) : 형변환 생략불가**

**형변환은 참조변수의 타입을 변환하는 것이지 인스턴스를 변환하는 것이 아니기 때문에**  
**참조변수의 형변환은 인스턴스에 아무런 영향을 미치지 않는다.**  
**단지 참조변수의 형변환을 통해서, 참조하고 있는 인스턴스에서 사용할 수 있는 멤버의**  
**범위(개수)를 조절하는 것뿐이다.**

> **서로 상속관계에 있는 타입간의 형변환은 양방향으로 자유롭게 수행될 수 있으나,**  
> **참조변수가 가리키는 인스턴스의 자손타입으로 형변환은 허용되지 않는다.**  
> **그래서 참조변수가 가리키는 인스턴스의 타입이 무엇인지 확인하는 것이 중요하다.**

#### instanceof 연산자
instanceod를 이용한 연산결과로 true를 얻었다는 것은 참조변수가 검사한 타입으로 형변환이 가능하다는 것을 뜻한다.
```java
main(){
  Car c = new Car();
  if(c instanceof Car){
  ...
  }
  if(c instanceof Machine){
  ...
  }
}  
class Machine {}
class Car extends Machine {}
```
실제 인스턴스와 같은 타입의 instanceof연산 이외에 조상타입의 instanceof연산에도 true 결과를 얻으며,  
instanceof연산의 결과가 true라는 것은 검사한 타입으로의 형변환을 해도 문제 없다.

#### 참조변수와 인스턴스의 연결
메서드의 경우 조상클래스의 메서드를 자손의 클래스에서 오버라이딩한 경우에도 
참조변수의 타입에 관계없이 항상 실제 인스턴스의 메서드(오버라이딩된 메서드)가 호출되지만,  
멤버변수의 경우 참조변수의 타입에 따라 달라진다.
